report,word,verb,objectType,prettyReg,match,label,sentence
Dofloo-BleepingComputer.csv,something,be,NET,eth.*,0,0,"securing docker servers while docker engine api abuse is not something new, it keeps being an issue because administrators do not know how to properly secure their systems."
Dofloo-BleepingComputer.csv,whether,allow,NET,eth.*,0,0,"allowing external access — whether intentionally or by misconfiguration — to api ports allows attackers to gain ownership of the host, giving them the ability to poison instances running within it with malware and to gain remote access to users’ servers and hardware resources, says trend micro."
Dofloo-MalwareMustDie.csv,0x000d0c24,be,MEM,mem_addr,0,0,"so as you can see it was served from sept 10th and is having 4 downloads (including me, one time)  the file looks like this:  1 2 3 4 5 6 $ ls -alf 1 -rwxr--r--  1 mmd  mmd  165,176 sep 10 10:21 1 $ md5 1 md5 (1) = 0bb68bd65d94f61b7b20117b99d8526c $ file 1 1: elf 32-bit lsb executable, arm, version 1 (gnu/linux), statically linked, stripped  well, we know is an arm binary, but i need more information, so i check the elf composition:  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15   entry point address:  0x2f118   start of program headers: 52 (bytes into file)   start of section headers: 0 (bytes into file)   flags: 0x4000002, has entry point, version4 eabi   size of this header: 52 (bytes)   size of program headers: 32 (bytes)   number of program headers: 2   size of section headers: 40 (bytes)   number of section headers: 0   section header string table index: 0   program headers:   type     offset   virtaddr   physaddr   filesiz memsiz  flg align   load     0x000000 0x00008000 0x00008000 0x282b1 0x282b1 r e 0x8000   load     0x000c24 0x000d0c24 0x000d0c24 0x00000 0x00000 rw  0x8000 now it's time for calculating the data, we know the size and we see the each load headers size which is just unfit, further, i don't see any section (either dynamic or static) nor relocation data that i can expect from an arm elf (they should have more symbols), which is strange."
Dofloo-MalwareMustDie.csv,ethernet,grab,NET,eth.*,0,0,"how it grabs the ethernet data, or how this malware use socket to connect an ip, for example, since the code is too long."
Dofloo-MalwareMustDie.csv,0x0002fcab,go,MEM,mem_addr,0,0,",0x24,0xa,0 0x0002fcab                 dcb 0x0 ;; here goes the table.. 0x0002fcac                 dcd 0x9a8, 0x5f9, 0x500e, 0x6c00031a, 0x942c5302, 0x18d063cb 0x0002fcac                 dcd 0x49382ee, 0xd185e779, 0x57399e2e, 0xd24c892f, 0x1003ea02 0x0002fcac                 dcd 0x6a5a70c9, 0x2f701d6a, 0x6d0d9a7, 0xd2ec6754, 0x95ece49 [...]                      [...]  oh, silly me.. it is a upx, but, is it common and not modded one?"
Dofloo-MalwareMustDie.csv,0x0002f120,"r1,r2,r10,r11,lr",MEM,mem_addr,0,0,"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ;-- entry0: 0x0002f118  adr     r12, off_2f104 0x0002f11c  ldmia   r12, {r1,r2,r10,r11,lr} 0x0002f120  add     r10, r10, r12 0x0002f124  add     r11, r11, r12 0x0002f128  mov     r0, r2 0x0002f12c  sub     r9, r12, r1 0x0002f130  add     r1, r1, #0x1000 0x0002f134  mov     r3, #0 0x0002f138  stmfd   sp!, {r0-r3,lr} 0x0002f13c  mov     r2, #7 0x0002f140  ldr     r3, [r12,#0x10] 0x0002f144  mov     r5, #0 0x0002f148  mov     r4, 0xffffffff 0x0002f14c  orr     r3, r3, #0x10 0x0002f150  mov     r7, #0xc0 0x0002f154  svc     0 0x0002f158  cmn     r0, #0x1000 0x0002f15c  bcs     loc_0x02fbd0   [...]  ..following the registers value and in r1 we will find the value that can tell what is happening:  1 2 3 4 5 0x0002fbd0  mov  r2, #0x1e 0x0002fbd4  adr  r1, aprot_execprot_ ; prot_exec|prot_write failed.\n 0x0002fbd8  mov  r0, #2 0x0002fbdc  mov  r7, #4 0x0002fbe0  svc  0 this value may ring your bells too :)."
Dofloo-MalwareMustDie.csv,0x00008000,have,MEM,mem_addr,0,0,"so as you can see it was served from sept 10th and is having 4 downloads (including me, one time)  the file looks like this:  1 2 3 4 5 6 $ ls -alf 1 -rwxr--r--  1 mmd  mmd  165,176 sep 10 10:21 1 $ md5 1 md5 (1) = 0bb68bd65d94f61b7b20117b99d8526c $ file 1 1: elf 32-bit lsb executable, arm, version 1 (gnu/linux), statically linked, stripped  well, we know is an arm binary, but i need more information, so i check the elf composition:  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15   entry point address:  0x2f118   start of program headers: 52 (bytes into file)   start of section headers: 0 (bytes into file)   flags: 0x4000002, has entry point, version4 eabi   size of this header: 52 (bytes)   size of program headers: 32 (bytes)   number of program headers: 2   size of section headers: 40 (bytes)   number of section headers: 0   section header string table index: 0   program headers:   type     offset   virtaddr   physaddr   filesiz memsiz  flg align   load     0x000000 0x00008000 0x00008000 0x282b1 0x282b1 r e 0x8000   load     0x000c24 0x000d0c24 0x000d0c24 0x00000 0x00000 rw  0x8000 now it's time for calculating the data, we know the size and we see the each load headers size which is just unfit, further, i don't see any section (either dynamic or static) nor relocation data that i can expect from an arm elf (they should have more symbols), which is strange."
Dofloo-MalwareMustDie.csv,0x0002fbf0,look,MEM,mem_addr,0,0,"i look from its dcb data from where it was called and clarifying the answer:  1 2 3 4 5 6 7 8 9 10 11 0x0002fbf0 aprot_execprot_ dcb prot_exec|prot_write failed.,0xa,0 0x0002fc0e                 dcb 0xa,0 0x0002fc10 ainfothisfileis dcb 0x24,info: this file is packed with the upx executable packer http:/ 0x0002fc10                 dcb /upx.sf.net ,0x24,0xa,0 0x0002fc5f aidupx3_91copyr dcb 0x24,id: upx 3.91 copyright (c) 1996-2013 the upx team."
Dofloo-MalwareMustDie.csv,rapid,be,ID,PID.*,0,0,"the growth is very rapid nowadays, mmd detected 5 variants is active under almost 15 panels scattered in china network."
Dofloo-MalwareMustDie.csv,sed,,PROC,^sed$,0,0,
Dofloo-MalwareMustDie.csv,"something,",,NET,eth.*,0,0,
Dofloo-MalwareMustDie.csv,method,call,NET,eth.*,0,0,"but to be noted, since arm architecture has different structure than intel, and arm is designed for the embedded systems, you will see many different method for the detail operation that is involving with the system calls."
Dofloo-MalwareMustDie.csv,182.254.180.0/23,,NET,ip_addr,0,0,
Dofloo-MalwareMustDie.csv,182.254.180.241,be,NET,ip_addr,0,0,"1 2 .text:0x09e68 ldr  r0, =unk_0x08c5c4  <-- address to get the cnc ip address .text:0x09e68 <-- go down to hard-copied data:0x08c5c8 it's the ip 182.254.180.241  now we know the cnc is in 182.254.180.241 which is in: ?"
Dofloo-MalwareMustDie.csv,0x0002f118,add,MEM,mem_addr,0,0,"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ;-- entry0: 0x0002f118  adr     r12, off_2f104 0x0002f11c  ldmia   r12, {r1,r2,r10,r11,lr} 0x0002f120  add     r10, r10, r12 0x0002f124  add     r11, r11, r12 0x0002f128  mov     r0, r2 0x0002f12c  sub     r9, r12, r1 0x0002f130  add     r1, r1, #0x1000 0x0002f134  mov     r3, #0 0x0002f138  stmfd   sp!, {r0-r3,lr} 0x0002f13c  mov     r2, #7 0x0002f140  ldr     r3, [r12,#0x10] 0x0002f144  mov     r5, #0 0x0002f148  mov     r4, 0xffffffff 0x0002f14c  orr     r3, r3, #0x10 0x0002f150  mov     r7, #0xc0 0x0002f154  svc     0 0x0002f158  cmn     r0, #0x1000 0x0002f15c  bcs     loc_0x02fbd0   [...]  ..following the registers value and in r1 we will find the value that can tell what is happening:  1 2 3 4 5 0x0002fbd0  mov  r2, #0x1e 0x0002fbd4  adr  r1, aprot_execprot_ ; prot_exec|prot_write failed.\n 0x0002fbd8  mov  r0, #2 0x0002fbdc  mov  r7, #4 0x0002fbe0  svc  0 this value may ring your bells too :)."
Dofloo-MalwareMustDie.csv,0x0002fc0e,pack,MEM,mem_addr,0,0,"i look from its dcb data from where it was called and clarifying the answer:  1 2 3 4 5 6 7 8 9 10 11 0x0002fbf0 aprot_execprot_ dcb prot_exec|prot_write failed.,0xa,0 0x0002fc0e                 dcb 0xa,0 0x0002fc10 ainfothisfileis dcb 0x24,info: this file is packed with the upx executable packer http:/ 0x0002fc10                 dcb /upx.sf.net ,0x24,0xa,0 0x0002fc5f aidupx3_91copyr dcb 0x24,id: upx 3.91 copyright (c) 1996-2013 the upx team."
Dofloo-MalwareMustDie.csv,method,use,NET,eth.*,0,0,"why i know it is aiming for router is because, the way to use internet to connect directly to remote global ip, the method used to grab data using specific location in the embedded device, and the trace of sources used during the compilation of the malware itself."
Dofloo-MalwareMustDie.csv,0x0002fbd0,find,MEM,mem_addr,0,0,"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ;-- entry0: 0x0002f118  adr     r12, off_2f104 0x0002f11c  ldmia   r12, {r1,r2,r10,r11,lr} 0x0002f120  add     r10, r10, r12 0x0002f124  add     r11, r11, r12 0x0002f128  mov     r0, r2 0x0002f12c  sub     r9, r12, r1 0x0002f130  add     r1, r1, #0x1000 0x0002f134  mov     r3, #0 0x0002f138  stmfd   sp!, {r0-r3,lr} 0x0002f13c  mov     r2, #7 0x0002f140  ldr     r3, [r12,#0x10] 0x0002f144  mov     r5, #0 0x0002f148  mov     r4, 0xffffffff 0x0002f14c  orr     r3, r3, #0x10 0x0002f150  mov     r7, #0xc0 0x0002f154  svc     0 0x0002f158  cmn     r0, #0x1000 0x0002f15c  bcs     loc_0x02fbd0   [...]  ..following the registers value and in r1 we will find the value that can tell what is happening:  1 2 3 4 5 0x0002fbd0  mov  r2, #0x1e 0x0002fbd4  adr  r1, aprot_execprot_ ; prot_exec|prot_write failed.\n 0x0002fbd8  mov  r0, #2 0x0002fbdc  mov  r7, #4 0x0002fbe0  svc  0 this value may ring your bells too :)."
Dofloo-MalwareMustDie.csv,"0x6c00031a,",,MEM,mem_addr,0,0,
Dofloo-MalwareMustDie.csv,0x0002f144,svc,MEM,mem_addr,0,0,"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ;-- entry0: 0x0002f118  adr     r12, off_2f104 0x0002f11c  ldmia   r12, {r1,r2,r10,r11,lr} 0x0002f120  add     r10, r10, r12 0x0002f124  add     r11, r11, r12 0x0002f128  mov     r0, r2 0x0002f12c  sub     r9, r12, r1 0x0002f130  add     r1, r1, #0x1000 0x0002f134  mov     r3, #0 0x0002f138  stmfd   sp!, {r0-r3,lr} 0x0002f13c  mov     r2, #7 0x0002f140  ldr     r3, [r12,#0x10] 0x0002f144  mov     r5, #0 0x0002f148  mov     r4, 0xffffffff 0x0002f14c  orr     r3, r3, #0x10 0x0002f150  mov     r7, #0xc0 0x0002f154  svc     0 0x0002f158  cmn     r0, #0x1000 0x0002f15c  bcs     loc_0x02fbd0   [...]  ..following the registers value and in r1 we will find the value that can tell what is happening:  1 2 3 4 5 0x0002fbd0  mov  r2, #0x1e 0x0002fbd4  adr  r1, aprot_execprot_ ; prot_exec|prot_write failed.\n 0x0002fbd8  mov  r0, #2 0x0002fbdc  mov  r7, #4 0x0002fbe0  svc  0 this value may ring your bells too :)."
Dofloo-MalwareMustDie.csv,0x0002fc5f,eserve,MEM,mem_addr,0,0,all rights r 0x0002fc5f                 dcb eserved.
Dofloo-Securityaffairs.csv,23.224.59.34:48080,connect,NET,ip_addr,1,1,the malware also connects to 23.224.59.34:48080 to send and receive remote shell commands from the attacker.
Dofloo-Securityaffairs.csv,/etc/rc.local,modify,FILE,/etc/rc\.local,1,1,"trend micro researchers also discovered that the latest variant of the aesddos bot can modify files i.e., /etc/rc.local and /etc/rc.d/rc.local, as an autostart technique by appending the {malware path}/{malware file name} reboot command."
Dofloo-Securityaffairs.csv,"/etc/rc.d/rc.local,",,FILE,/etc/rc.*\.d/.*,0,0,
Dofloo-SyscallParty.csv,vaddr=0x00013dec,give,MEM,mem_addr,0,0,which gives us the following output:  vaddr=0x00013dec paddr=0x0000bdec ord=5366 fwd=none sz=688 bind=global type=func name=main nice!
Dofloo-SyscallParty.csv,method,pass,NET,eth.*,0,0,the number of cpus is then passed back out from this method and the clock speed in mhz too.
Dofloo-SyscallParty.csv,method,be,NET,eth.*,0,0,this is the only persistence method used by the bot.
Dofloo-SyscallParty.csv,/etc/rc.local,execute,FILE,/etc/rc\.local,0,0,the /etc/rc.local will execute certain commands after all of the systems' services have started.
Dofloo-SyscallParty.csv,‘uname’,,INFO,uname(.|$),0,0,
Dofloo-SyscallParty.csv,/proc/net/dev,read,FILE,/proc/net/dev,0,0,the way the malware gets information regarding the network adapter is reading the /proc/net/dev file.
Dofloo-SyscallParty.csv,gethostbyname,put,NET,eth.*,0,0,we pass in the first parameter in the register ‘r0’ from the location 0xc1fc8 which has the value of 61.147.91.53. we put the return value os gethostbyname into register r3 then preform some arithmetic on it.
Dofloo-SyscallParty.csv,methods,move,NET,eth.*,0,0,"this is the end of this section, we will now move onto the details about the attack methods and what else the bot can be commanded to do."
Dofloo-SyscallParty.csv,/etc/rc.local,add,FILE,/etc/rc\.local,1,1,persistence persistence is achieved by the malware by adding to /etc/rc.local and the /etc/init.d/boot.local files (in the auto_boot function); however before it overwrites this file it first checks to see if it has already done so.
Dofloo-SyscallParty.csv,method,,NET,eth.*,0,0,
Dofloo-SyscallParty.csv,/proc/self/exe,,FILE,/proc/self,0,0,
Dofloo-SyscallParty.csv,61.147.91.53.,,NET,ip_addr,0,0,
Dofloo-SyscallParty.csv,sed,format,PROC,^sed$,0,0,"a string is formatted and the sed program is called which writes to the file in question (there are several string operations, such as sed -i -e '2 i%s/%s' /etc/rc.local is formatted for example)."
Dofloo-SyscallParty.csv,/etc/init.d/boot.local,add,FILE,/etc/init\.d/.*,1,1,persistence persistence is achieved by the malware by adding to /etc/rc.local and the /etc/init.d/boot.local files (in the auto_boot function); however before it overwrites this file it first checks to see if it has already done so.
Dofloo-SyscallParty.csv,/etc/rc.local,format,FILE,/etc/rc\.local,1,1,"a string is formatted and the sed program is called which writes to the file in question (there are several string operations, such as sed -i -e '2 i%s/%s' /etc/rc.local is formatted for example)."
Dofloo-Trendmicro.csv,sed,se,PROC,^sed$,0,0, installation  this backdoor adds the following processes:  sed -i -e '/exit/d' /etc/rc.local sed -i -e '/^\r\n|\r|\n$/d' /etc/rc.local sed -i -e '/%s/d' /etc/rc.local sed -i -e '2 i%s/%s' /etc/rc.local sed -i -e '2 i%s/%s start' /etc/rc.d/rc.local sed -i -e '2 i%s/%s start' /etc/init.d/boot.local backdoor routine 
Dofloo-Trendmicro.csv,/etc/rc.d/rc.local,se,FILE,/etc/rc.*\.d/.*,0,0, installation  this backdoor adds the following processes:  sed -i -e '/exit/d' /etc/rc.local sed -i -e '/^\r\n|\r|\n$/d' /etc/rc.local sed -i -e '/%s/d' /etc/rc.local sed -i -e '2 i%s/%s' /etc/rc.local sed -i -e '2 i%s/%s start' /etc/rc.d/rc.local sed -i -e '2 i%s/%s start' /etc/init.d/boot.local backdoor routine 
Dofloo-Trendmicro.csv,/proc/net/dev,,FILE,/proc/net/dev,0,0,
Dofloo-Trendmicro.csv,/etc/rc.local,se,FILE,/etc/rc\.local,0,0, installation  this backdoor adds the following processes:  sed -i -e '/exit/d' /etc/rc.local sed -i -e '/^\r\n|\r|\n$/d' /etc/rc.local sed -i -e '/%s/d' /etc/rc.local sed -i -e '2 i%s/%s' /etc/rc.local sed -i -e '2 i%s/%s start' /etc/rc.d/rc.local sed -i -e '2 i%s/%s start' /etc/init.d/boot.local backdoor routine 
Dofloo-Trendmicro.csv,/proc/stat,gather,FILE,/proc/stat,0,0, this backdoor gathers the following data:  cpu information memory statistics ip address of infected machine reads the following information from /proc: /proc/stat /proc/meminfo /proc/cpuinfo /proc/net/dev /proc/self/exe /proc/self/maps /proc/sys/vm/overcommit_memory /proc/sys/kernel/rtsig-max /proc/sys/kernel/ngroups_max /proc/sys/kernel/osrelease /proc/self/fd/%d/%s /proc/self/fd /proc/net other details 
Dofloo-Trendmicro.csv,/etc/suid-debug,,ID,UID.*,0,0,
Dofloo-Trendmicro.csv,/proc/self/exe,,FILE,/proc/self,0,0,
Dofloo-Trendmicro.csv,/etc/init.d/boot.local,start,FILE,/etc/init\.d/.*,0,0, installation  this backdoor adds the following processes:  sed -i -e '/exit/d' /etc/rc.local sed -i -e '/^\r\n|\r|\n$/d' /etc/rc.local sed -i -e '/%s/d' /etc/rc.local sed -i -e '2 i%s/%s' /etc/rc.local sed -i -e '2 i%s/%s start' /etc/rc.d/rc.local sed -i -e '2 i%s/%s start' /etc/init.d/boot.local backdoor routine 
