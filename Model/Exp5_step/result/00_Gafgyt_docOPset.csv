report,word,verb,objectType,prettyReg,match,label,asgSyscall,sentence
Gafgyt-fortinet.csv,"112.208.0.0/14,",,NET,ip_addr/ip_addr:port/port,0,0,,"The first argument indicates the number of running threads for the script, and the second indicates the IP ranges to scan, which are:  122.3.0.0/16, 122.52.0.0/15, 122.54.0.0/16, 124.83.0.0/16, 124.105.0.0/16, 124.106.0.0/15, 112.200.0.0/13, 112.208.0.0/14, 112.212.0.0/15,112.214.0.0/16,210.213.0.0/16  The third argument is used to specify an IP instead of the string “LUCKY.” It indicates the end of the range to scan, and the last parameter is an index to a list of strings in “user:password.” {(admin, 1234) (root,root) (guest,guest) (telnet,telnet)} are used to log in to the SSH service"
Gafgyt-fortinet.csv,"122.3.0.0/16,",be,NET,ip_addr/ip_addr:port/port,0,0,,"The first argument indicates the number of running threads for the script, and the second indicates the IP ranges to scan, which are:  122.3.0.0/16, 122.52.0.0/15, 122.54.0.0/16, 124.83.0.0/16, 124.105.0.0/16, 124.106.0.0/15, 112.200.0.0/13, 112.208.0.0/14, 112.212.0.0/15,112.214.0.0/16,210.213.0.0/16  The third argument is used to specify an IP instead of the string “LUCKY.” It indicates the end of the range to scan, and the last parameter is an index to a list of strings in “user:password.” {(admin, 1234) (root,root) (guest,guest) (telnet,telnet)} are used to log in to the SSH service"
Gafgyt-fortinet.csv,8.8.8.8,execute,NET,ip_addr/ip_addr:port/port,0,0,,After the Gafgyt bot executes it establishes a connection to IP address 8.8.8.8 on port 53 in order to track the internet activity of its targeted victim
Gafgyt-nozominetworks.csv,PID,issue,ID,^PID.*,0,0,," Another way this functionality is implemented is by issuing a kill -9 PID command, as shown in Figure 10:  Fig 10 botkill command Figure 10"
Gafgyt-nozominetworks.csv,62.197.136.231,,NET,ip_addr/ip_addr:port/port,0,0,, IoCs 62.197.136.231 80.76.51.244 2b1cc052f78141d91e1bc40db25418359a05c4ad28d2cd55f6e503e4f78c1010 05e586d03dfb2c4a79372d46f2f4a8a91bf24d303017a0ce9f223263b28752a5
Gafgyt-sectrio.csv,(/proc/net/route),open/use,FILE,/proc/net/route,1,1,open() read()," From above image (Figure 4) malware checks for the internet connection, get IP of the machine and open the system routing table (/proc/net/route) to get the list of active network interfaces with their relative configuration"
Gafgyt-sectrio.csv,pid,check/get,ID,^PID.*,1,1,getppid() getpid()," Fig 3: Malware checking machine time, IP and pid of itself"
Gafgyt-sectrio.csv,176.32.37.93,,NET,ip_addr/ip_addr:port/port,0,0,,STD 176.32.37.93 7777 50\n” command from the C&C
Gafgyt-sectrio.csv,176.32.37.93,trim,NET,ip_addr/ip_addr:port/port,0,0,,"STD 176.32.37.93 7777 50\n” then malware trims the first part of the command which tells malware to perform specific type of attack, then trim the IP from the command which tells malware to perform attack on which victim then there is the packet size of each packet send to perform DDoS attack"
Gafgyt-securityscorecard.csv,“/proc/net/route”:,open,FILE,/proc/net/route,1,1,open(), The process opens the kernel routing table from “/proc/net/route”:
Gafgyt-securityscorecard.csv,PID,store,ID,^PID.*,0,0,,"An example of such a command is shown below: In a function called listFork, the binary creates a child process using the fork method and stores its PID in a variabile called “pids”: Now we’ll describe the functions that are used in the main commands: ftcp, vseattack1, rand_hex, udppac2, udppac, jailv1, icmpattack, rtcp, sendJUNK, tcpFl00d, ovhl7, udpfl00d, and kickv2"
Gafgyt-securityscorecard.csv,(0xF,,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,, The current process name is set to “/usr/bin/apt” using the prctl function (0xF = PR_SET_NAME):
Gafgyt-securityscorecard.csv,0x2,create,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"It creates a new socket by calling the socket method (0x2 = AF_UNIX, 0x2 = SOCK_DGRAM): Figure 7 The inet_addr function is utilized to convert the Google DNS server into binary data in network byte order: The malware performs a connection to the Google DNS server on port 53 via a function call to connect, as highlighted below:"
Gafgyt-securityscorecard.csv,0x4,extract,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"In the getHost function, the C2 IP address is converted into binary data in network byte order using inet_addr: Figure 24 The connect function is utilized to perform a connection to the C2 server: The process extracts information about the error status via a call to getsockopt (0x1 = SOL_SOCKET, 0x4 = SO_ERROR): The IP address of the device is converted to a string, and the binary will send a packet containing the string and the architecture that is hard-coded (“x86_64”) to the C2 server: Figure 27 The confirmation message that contains the device’s IP address and the architecture is sent to the C2 server using the send method, as shown in the figure below"
Gafgyt-securityscorecard.csv,45.61.186.4:13561,,NET,ip_addr/ip_addr:port/port,0,0,, Indicators of Compromise C2 server 45.61.186.4:13561
Gafgyt-securityscorecard.csv,45.61.186.4,establish/initiate,NET,ip_addr/ip_addr:port/port,1,1,connect(),It will establish a connection with the C2 server 45.61.186.4 on port 13561 (see figure 21)
Gafgyt-securityscorecard.csv,“8.8.8.8”,,NET,ip_addr/ip_addr:port/port,0,0,," In the function called util_local_addr, the binary creates a datagram socket and performs a connection to the Google DNS server “8.8.8.8” in order to obtain the device’s IP address (see figure 51)"
Gafgyt-unit42-2.csv,"0xBAADF00D,",,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"]183.53.120	Two different keys used – 0xBAADF00D, 0xDEADBEEF (or the equivalent of a byte-wise XOR with 0x22)	No 2: Okane	All exploits in Table 1	Mirai	hxxp://46["
Gafgyt-unit42-2.csv,0xBAADF00D,make,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"Differentiating features of the campaign:  Two different encryption schemes: Aside from using the standard XOR encryption scheme seen in all Mirai variants, in this case using the table key 0xBAADF00D samples make use of a second key for the encryption of certain config strings"
Gafgyt-unit42-2.csv,0xDEADBEEF,use,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"]183.53.120	Two different keys used – 0xBAADF00D, 0xDEADBEEF (or the equivalent of a byte-wise XOR with 0x22)	No 2: Okane	All exploits in Table 1	Mirai	hxxp://46["
Gafgyt-unit42-2.csv,http://46.243.189.101/gang/,locate,NET,ip_addr/ip_addr:port/port,0,0,, The payload source in this attack was located at http://46.243.189.101/gang/
Gafgyt-unit42-2.csv,46.243.189.101,screenshot,NET,ip_addr/ip_addr:port/port,0,0,, Figure 4: Screenshot from open directory at payload server 46.243.189.101
Gafgyt-unit42-2.csv,213.183.53.120,,NET,ip_addr/ip_addr:port/port,0,0,,213.183.53.120 at port 8013 for C2 communication
Gafgyt-unit42-2.csv,chromeframe/11.0.696.57),file_41,NET,ip_addr/ip_addr:port/port,0,0,," APPENDIX  User-Agents used by Gafgyt HTTPCF samples MOT-L7/08.B7.ACR MIB/2.2.1 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mozilla/5.0 (compatible; Teleca Q7; Brew 3.1.5; U; en) 480X800 LGE VX11000 Mozilla/5.0 (Android; Linux armv7l; rv:9.0) Gecko/20111216 Firefox/9.0 Fennec/9.0 MOT-V300/0B.09.19R MIB/2.2 Profile/MIDP-2.0 Configuration/CLDC-1.0 Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; FunWebProducts) Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0; FDM; MSIECrawler; Media Center PC 5.0) Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:5.0) Gecko/20110517 Firefox/5.0 Fennec/5.0 Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_7; en-us) AppleWebKit/530.17 (KHTML, like Gecko) Version/4.0 Safari/530.17 Skyfire/2.0 SonyEricssonW800i/R1BD001/SEMC-Browser/4.2 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0; chromeframe/11.0.696.57) Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; uZardWeb/1.0; Server_JP) Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.19 (KHTML, like Gecko) Chrome/1.0.154.39 Safari/525.19 Mozilla/5.0 (Linux; Android 4.4.3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.89 Mobile Safari/537.36 Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36 Mozilla/5.0 (X11; Linux x86_64; U; de; rv:1.9.1.6) Gecko/20091201 Firefox/3.5.6 Opera 10.62 Opera/9.80 (Windows NT 5.1; U;) Presto/2.7.62 Version/11.01 Opera/9.80 (X11; Linux i686; Ubuntu/14.10) Presto/2.12.388 Version/12.16 BlackBerry9700/5.0.0.743 Profile/MIDP-2.1 Configuration/CLDC-1.1 VendorID/100 BlackBerry7520/4.0.0 Profile/MIDP-2.0 Configuration/CLDC-1.1 Doris/1.15 [en] (Symbian) Bunjalloo/0.7.6(Nintendo DS;U;en) PSP (PlayStation Portable); 2.00 Mozilla/4.0 (PSP (PlayStation Portable); 2.00) wii libnup/1.0 Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Thunderbird/38.2.0 Lightning/4.0.2 Mozilla/5.0 (PLAYSTATION 3; 3.55) Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko/20090327 Galeon/2.0.7 Mozilla/5.0 (Windows; U; Win 9x 4.90; SG; rv:1.9.2.4) Gecko/20101104 Netscape/9.1.0285 Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; MyIE2; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0) Mozilla/5.0 (Windows; U; Windows NT 6.1; cs; rv:1.9.2.6) Gecko/20100628 myibrow/4alpha2 Mozilla/5.0 (X11; U; Linux i686; pl-PL; rv:1.9.0.6) Gecko/2009020911 Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201 Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en; rv:1.8.1.11) Gecko/20071128 Camino/1.5.4 Mozilla/5.0 (compatible; U; ABrowse 0.6; Syllable) AppleWebKit/420+ (KHTML, like Gecko) Mozilla/5.0 (X11; U; Linux ppc; en-US; rv:1.9a8) Gecko/2007100620 GranParadiso/3.1 Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0"
Gafgyt-unit42-2.csv,46.243.189.101,serve,NET,ip_addr/ip_addr:port/port,0,0,, CAMPAIGN 2: Okane Samples from this campaign were served from the IP 46.243.189.101
Gafgyt-unit42.csv,0xdeadf00d,use,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"They use l.ocalhost.host:47883 as C2, and the same encryption scheme as Mirai with the key 0xdeadf00d"
Gafgyt-unit42.csv,185.10.68.127,resolve,NET,ip_addr/ip_addr:port/port,0,0,,"For part of the month of August 2018, that same domain resolved to a different IP address 185.10.68.127"
