report,word,verb,objectType,prettyReg,match,label,asgSyscall,sentence
HCRootkit-lacework.csv,/proc/.inl,write/extract,FILE,/proc/\.inl,1,1,open(),"Figure 2 – Kernel Module Written to Disk   After writing the kernel module to disk, the embedded userland component is written to either /proc/.inl or /tmp/.tmp_XXXXXX depending on whether or not the open command succeeded for /proc/.inl"
HCRootkit-lacework.csv,/proc/.inl,file_1,FILE,/proc/\.inl,0,0,,"$a2 = /tmp/.tmp_XXXXXX 		$s1 = /proc/net/tcp 		$s2 = /proc/.inl 		$s3 = rootkit 	condition: 		uint32(0)==0x464c457f and  		((any of ($a*)) and (any of ($s*))) }  rule linux_mal_hcrootkit_2 { 	meta: 		description = Detects Linux HCRootkit Wide, unpacked 		hash1 = 2daa5503b7f068ac471330869ccfb1ae617538fecaea69fd6c488d57929f8279 		hash2 = 10c7e04d12647107e7abf29ae612c1d0e76a79447e03393fa8a44f8a164b723d 		author = Lacework Labs 		ref = https://posts.lacework.com/blog/hcrootkit-sutersu-linux-rootkit-analysis/ 	strings: 		$s1 = s_hide_pids 		$s2 = handler_kallsyms_lookup_name 		$s3 = s_proc_ino 		$s4 = n_filldir 		$s5 = s_is_proc_ino 		$s6 = n_tcp4_seq_show 		$s7 = r_tcp4_seq_show 		$s8 = s_hide_tcp4_ports 		$s9 = s_proc_open 		$s10 = s_proc_show 		$s11 = s_passwd_buf 		$s12 = s_passwd_buf_len 		$s13 = r_sys_write 		$s14 = r_sys_mmap 		$s15 = r_sys_munmap 		$s16 = s_hide_strs 		$s17 = s_proc_write 		$s18 = s_proc_inl_operations 		$s19 = s_inl_entry 		$s20 = kp_kallsyms_lookup_name 		$s21 = s_sys_call_table 		$s22 = kp_do_exit 		$s23 = r_sys_getdents 		$s24 = s_hook_remote_ip 		$s25= s_hook_remote_port 		$s26 = s_hook_local_port 		$s27 = s_hook_local_ip 		$s28 = nf_hook_pre_routing 	condition: 		uint32(0)==0x464c457f and 10 of them }  rule linux_mal_suterusu_rootkit { 	meta: 		description = Detects open source rootkit named suterusu 		hash1 = 7e5b97135e9a68000fd3efee51dc5822f623b3183aecc69b42bde6d4b666cfe1 		hash2 = 7b48feabd0ffc72833043b14f9e0976511cfde39fd0174a40d1edb5310768db3 		author = Lacework Labs 		ref = https://posts.lacework.com/blog/hcrootkit-sutersu-linux-rootkit-analysis/ 	strings: 		$a1 = suterusu 		$a3 = srcversion= 		$a4 = Hiding PID 		$a5 = /proc/net/tcp 	condition: 		uint32(0)==0x464c457f and all of them }"
HCRootkit-lacework.csv,/tmp/.tmp_XXXXXX,write/extract,FILE,/tmp.*,1,1,write() open(),"Figure 2 – Kernel Module Written to Disk   After writing the kernel module to disk, the embedded userland component is written to either /proc/.inl or /tmp/.tmp_XXXXXX depending on whether or not the open command succeeded for /proc/.inl"
HCRootkit-lacework.csv,/tmp/.tmp_XXXXXX,,FILE,/tmp.*,0,0,,"$a2 = /tmp/.tmp_XXXXXX 		$s1 = /proc/net/tcp 		$s2 = /proc/.inl 		$s3 = rootkit 	condition: 		uint32(0)==0x464c457f and  		((any of ($a*)) and (any of ($s*))) }  rule linux_mal_hcrootkit_2 { 	meta: 		description = Detects Linux HCRootkit Wide, unpacked 		hash1 = 2daa5503b7f068ac471330869ccfb1ae617538fecaea69fd6c488d57929f8279 		hash2 = 10c7e04d12647107e7abf29ae612c1d0e76a79447e03393fa8a44f8a164b723d 		author = Lacework Labs 		ref = https://posts.lacework.com/blog/hcrootkit-sutersu-linux-rootkit-analysis/ 	strings: 		$s1 = s_hide_pids 		$s2 = handler_kallsyms_lookup_name 		$s3 = s_proc_ino 		$s4 = n_filldir 		$s5 = s_is_proc_ino 		$s6 = n_tcp4_seq_show 		$s7 = r_tcp4_seq_show 		$s8 = s_hide_tcp4_ports 		$s9 = s_proc_open 		$s10 = s_proc_show 		$s11 = s_passwd_buf 		$s12 = s_passwd_buf_len 		$s13 = r_sys_write 		$s14 = r_sys_mmap 		$s15 = r_sys_munmap 		$s16 = s_hide_strs 		$s17 = s_proc_write 		$s18 = s_proc_inl_operations 		$s19 = s_inl_entry 		$s20 = kp_kallsyms_lookup_name 		$s21 = s_sys_call_table 		$s22 = kp_do_exit 		$s23 = r_sys_getdents 		$s24 = s_hook_remote_ip 		$s25= s_hook_remote_port 		$s26 = s_hook_local_port 		$s27 = s_hook_local_ip 		$s28 = nf_hook_pre_routing 	condition: 		uint32(0)==0x464c457f and 10 of them }  rule linux_mal_suterusu_rootkit { 	meta: 		description = Detects open source rootkit named suterusu 		hash1 = 7e5b97135e9a68000fd3efee51dc5822f623b3183aecc69b42bde6d4b666cfe1 		hash2 = 7b48feabd0ffc72833043b14f9e0976511cfde39fd0174a40d1edb5310768db3 		author = Lacework Labs 		ref = https://posts.lacework.com/blog/hcrootkit-sutersu-linux-rootkit-analysis/ 	strings: 		$a1 = suterusu 		$a3 = srcversion= 		$a4 = Hiding PID 		$a5 = /proc/net/tcp 	condition: 		uint32(0)==0x464c457f and all of them }"
HCRootkit-lacework.csv,PID,,ID,^PID.*,0,0,,"$a2 = /tmp/.tmp_XXXXXX 		$s1 = /proc/net/tcp 		$s2 = /proc/.inl 		$s3 = rootkit 	condition: 		uint32(0)==0x464c457f and  		((any of ($a*)) and (any of ($s*))) }  rule linux_mal_hcrootkit_2 { 	meta: 		description = Detects Linux HCRootkit Wide, unpacked 		hash1 = 2daa5503b7f068ac471330869ccfb1ae617538fecaea69fd6c488d57929f8279 		hash2 = 10c7e04d12647107e7abf29ae612c1d0e76a79447e03393fa8a44f8a164b723d 		author = Lacework Labs 		ref = https://posts.lacework.com/blog/hcrootkit-sutersu-linux-rootkit-analysis/ 	strings: 		$s1 = s_hide_pids 		$s2 = handler_kallsyms_lookup_name 		$s3 = s_proc_ino 		$s4 = n_filldir 		$s5 = s_is_proc_ino 		$s6 = n_tcp4_seq_show 		$s7 = r_tcp4_seq_show 		$s8 = s_hide_tcp4_ports 		$s9 = s_proc_open 		$s10 = s_proc_show 		$s11 = s_passwd_buf 		$s12 = s_passwd_buf_len 		$s13 = r_sys_write 		$s14 = r_sys_mmap 		$s15 = r_sys_munmap 		$s16 = s_hide_strs 		$s17 = s_proc_write 		$s18 = s_proc_inl_operations 		$s19 = s_inl_entry 		$s20 = kp_kallsyms_lookup_name 		$s21 = s_sys_call_table 		$s22 = kp_do_exit 		$s23 = r_sys_getdents 		$s24 = s_hook_remote_ip 		$s25= s_hook_remote_port 		$s26 = s_hook_local_port 		$s27 = s_hook_local_ip 		$s28 = nf_hook_pre_routing 	condition: 		uint32(0)==0x464c457f and 10 of them }  rule linux_mal_suterusu_rootkit { 	meta: 		description = Detects open source rootkit named suterusu 		hash1 = 7e5b97135e9a68000fd3efee51dc5822f623b3183aecc69b42bde6d4b666cfe1 		hash2 = 7b48feabd0ffc72833043b14f9e0976511cfde39fd0174a40d1edb5310768db3 		author = Lacework Labs 		ref = https://posts.lacework.com/blog/hcrootkit-sutersu-linux-rootkit-analysis/ 	strings: 		$a1 = suterusu 		$a3 = srcversion= 		$a4 = Hiding PID 		$a5 = /proc/net/tcp 	condition: 		uint32(0)==0x464c457f and all of them }"
HCRootkit-lacework.csv,uid,,ID,^UID.*,0,0,,"cmd.proto {     cmd     SessionInfo     desc     hide     uid     Init     key     sysinfo     SystemVersion     version     system     RequestVersion     app_type     ResponseVersion     size     app_type     RequestUpdateDownload     size     app_type     ResponseUpdateDownload     off     data     app_type     Upload_Passwd }  cmd.Upload_Passwd.PasswordInfo{     PasswordInfo     address     port     username     password     Tick     Show_Msg     message     Forward_Data     src_uid     dest_uid     cmd     data     Host_List }  cmd.Host_List.Host_Info {     Host_Info     ip     system     hide     version     nonlinetime     desc     Session_Connect     uid     Session_DisConnect     uid     Verify     username     password     CommonCommand     cmd     args } cmd.CommonCommand.Command_Info {     Command_Info     name     value     List_Dir     files }  cmd.List_Dir.List_Info {     dir     List_Info     name     modify_date     isdir     size     executable     readonly     writeable     Fwd_Beg     code     message     Fwd_Ing     data     Fwd_End     code     message }   Figure 13 – Extracted Custom Protobuf    Custom Ghidra Scripts  To aid in the analysis and triage of key IoCs from the malware discussed above, Lacework Labs is releasing two Ghidra scripts to aid defenders and researchers alike"
HCRootkit-lacework.csv,(0x4f00),,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"After writing 20224 bytes (0x4f00) to the temporary file, the file descriptor is closed and then the insmod utility is used to install this kernel module"
HCRootkit-lacework.csv,dmesg,clear,PROC,^dmesg$,0,0,,"Finally, the dmesg utility is used to clear the dmesg output (T1070,) which would contain forensic artifacts of a kernel module being installed as well as remove the underlying ELF binary via unlink"
HCRootkit-lacework.csv,insmod,fail,PROC,^insmod$,0,0,,"If secure boot is enabled on the underlying system (which would require signed kernel modules) or the kernel version is not what the kernel module was compiled for, insmod will fail"
HCRootkit-lacework.csv,insmod,use,PROC,^insmod$,0,0,,"After writing 20224 bytes (0x4f00) to the temporary file, the file descriptor is closed and then the insmod utility is used to install this kernel module"
