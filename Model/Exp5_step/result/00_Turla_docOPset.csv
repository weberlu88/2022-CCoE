report,word,verb,objectType,prettyReg,match,label,asgSyscall,sentence
Turla-leonardo.csv,PID,report,ID,^PID.*,0,0,,"A very important piece of code, that was not previously described in any analysis we know about, is used by the three malware sets: result = trybuiltin(a2, v9, v10); if ( !result ): result = runcmd((int)v4, v9, (int)v10, a4); The runcmd function is the one described by Kaspersky: “[the malware] reports its own PID and IP to the remote address, and starts an endless loop for receiving remote commands"
Turla-leonardo.csv,0x1bebe,become,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"Even though the bitmask remained the same for all versions (0xe007ffff), the result value has changed between different releases (0xe003bebe or 0x1bebe became 0x6005bdbd)"
Turla-leonardo.csv,0x9999,send,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"import socket tc_remote_port = 0x9999 outgoing_if = 192.168.202.1 # local IP remote_tc_host = 192.168.202.130 # potentially infected machine IP #send UDP packet with final_check2 equal to 2 and callback IP address equal to 10.11.60.129 tc_local_port = 65105 tc_sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) tc_sock.bind((outgoing_if, tc_local_port)) tc_sock.sendto(b\x4a\x0a\x3c\x83\x60\x95\xbd\xbd, (remote_tc_host,tc_remote_port)) #send UDP packet with final_check2 equal to 0 and callback IP address equal to 10.188.60.129 tc_local_port = 30846 tc_sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) tc_sock.bind((outgoing_if, tc_local_port)) tc_sock.sendto(b\x0a\xbc\x3c\x80\x62\x85\xbd\xbd, (remote_tc_host,tc_remote_port)) The variables that can be freely configured are: tc_remote_port, outgoing_if and remote_tc_host"
Turla-leonardo.csv,0xbdbd0560,appear,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"The second DWORD should appear familiar since it corresponds to the value specified in the pcap filter (for example, 0xbdbd0560 for “Penquin_x64” samples)"
Turla-leonardo.csv,0xe007ffff,tcp[8:4,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"However, the filter applied by the stealth backdoor capability of “Penquin” and “Penquin_x64” is slightly different as reported below: “Penquin” magic packet filter (tcp[8:4] & 0xe007ffff = 0xe003bebe) or (udp[12:4] & 0xe007ffff = 0xe003bebe) (tcp[8:4] & 0xe007ffff = 0x1bebe) or (udp[12:4] & 0xe007ffff = 0x1bebe) “Penquin_x64” magic packet filter (tcp[8:4] & 0xe007ffff = 0x6005bdbd) or (udp[12:4] & 0xe007ffff = 0x6005bdbd)"
Turla-leonardo.csv,0x5);,,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,This kind of technique is also peculiar of other tools used by Turla: index = 0; do{ _decrypted__buffer[index] = _xored__buffer[index] ^ (index + 0x5); ++index; } while ( index <= _xored__buffer_size);
Turla-leonardo.csv,0x457f,fullword,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,ascii fullword $s5 = /tmp/.sync.pid ascii fullword $s6 = rem_fd: ssl  ascii fullword $s7 = TREX_PID=%u ascii fullword $s8 = /tmp/.xdfg ascii fullword $s9 = __we_are_happy__ ascii fullword $s10 = /root/.sess ascii fullword $s11 = ZYSZLRTS^Z@@NM@@G_Y_FE ascii fullword condition: uint16(0) == 0x457f and filesize < 5000KB and 4 of them }
Turla-leonardo.csv,"10.188.60.129,",,NET,ip_addr/ip_addr:port/port,0,0,,"Since we are unable to establish the value of the status flag in advance, two packets are sent in order to trigger the connection to one of the two private IP addresses 10.11.60.129 or 10.188.60.129, that should be used by the system administrators to monitor the call back home traffic of “Penquin_x64”"
Turla-leonardo.csv,192.168.202.1,send/connect,NET,ip_addr/ip_addr:port/port,1,1,connect(),"import socket tc_remote_port = 0x9999 outgoing_if = 192.168.202.1 # local IP remote_tc_host = 192.168.202.130 # potentially infected machine IP #send UDP packet with final_check2 equal to 2 and callback IP address equal to 10.11.60.129 tc_local_port = 65105 tc_sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) tc_sock.bind((outgoing_if, tc_local_port)) tc_sock.sendto(b\x4a\x0a\x3c\x83\x60\x95\xbd\xbd, (remote_tc_host,tc_remote_port)) #send UDP packet with final_check2 equal to 0 and callback IP address equal to 10.188.60.129 tc_local_port = 30846 tc_sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) tc_sock.bind((outgoing_if, tc_local_port)) tc_sock.sendto(b\x0a\xbc\x3c\x80\x62\x85\xbd\xbd, (remote_tc_host,tc_remote_port)) The variables that can be freely configured are: tc_remote_port, outgoing_if and remote_tc_host"
Turla-leonardo.csv,82.146.175.43:1773,hardcode,NET,ip_addr/ip_addr:port/port,0,0,,"Malware Instances (SHA256) 1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905, 3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4 8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667, 2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08, 5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8, d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0 8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc 67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502 d9f2467ff11efae921ec83e074e4f8d2eac7881d76bff60a872a801bd45ce3d5 Specific malware samples belonging to the corresponding families C2 Domains news-bbc.podzone.org C2 hardcoded domains C2 IP and Ports 82.146.175.43:1773 C2 hardcoded IP addresses and ports"
Turla-leonardo.csv,82.146.175.43:1773,hardcode,NET,ip_addr/ip_addr:port/port,0,0,,"Malware Instances (SHA256) 1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905, 3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4 8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667, 2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08, 5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8, d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0 8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc 67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502 d9f2467ff11efae921ec83e074e4f8d2eac7881d76bff60a872a801bd45ce3d5 Specific malware samples belonging to the corresponding families C2 Domains news-bbc.podzone.org C2 hardcoded domains C2 IP and Ports 82.146.175.43:1773 C2 hardcoded IP addresses and ports"
Turla-leonardo.csv,10.11.60.129,trigger,NET,ip_addr/ip_addr:port/port,0,0,,"Since we are unable to establish the value of the status flag in advance, two packets are sent in order to trigger the connection to one of the two private IP addresses 10.11.60.129 or 10.188.60.129, that should be used by the system administrators to monitor the call back home traffic of “Penquin_x64”"
Turla-securelist.csv,PID,report/get,ID,^PID.*,1,1,getpid(),"Then it reports its own PID and IP to the remote address, and starts an endless loop for receiving remote commands"
Turla-securelist.csv,PID,return,ID,^PID.*,0,0,,"After the ID and interface name are entered and the process launched, the backdoor’s process PID is returned"
Turla-securelist.csv,0xe007ffff,,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"This condition is expressed here (it is based on the ID value input at startup by the attacker):  ID = 123 Filter = (tcp[8:4] & 0xe007ffff = 0xe003bebe) or (udp[12:4] & 0xe007ffff = 0xe003bebe) ID = 321 Filter = (tcp[8:4] & 0xe007ffff = 0x1bebe) or (udp[12:4] & 0xe007ffff = 0x1bebe) In simple terms, it checks for an ACK number in the TCP header, or the second byte from the UDP packet body"
Turla-securelist.csv,80.248.65.183,filter,NET,ip_addr/ip_addr:port/port,0,0,,]org The domain has the following pDNS IP: 80.248.65.183  80.248.65.183 aut-num:        AS30982 announcement:   80.248.65.0/24 as-name:        CAFENET descr:          CAFE Informatique et telecommunications admin-c:        YN2-AFRINIC tech-c:         AN39-AFRINIC org:            ORG-CIet1-AFRINIC mnt-by:         AFRINIC-HM-MNT mnt-lower:      CAFENET-NOC source:         AFRINIC # Filtered 1 2 3 4 5 6 7 8 9 10 11 80.248.65.183 aut-num:        AS30982 announcement:   80.248.65.0/24 as-name:        CAFENET descr:          CAFE Informatique et telecommunications admin-c:        YN2-AFRINIC tech-c:         AN39-AFRINIC org:            ORG-CIet1-AFRINIC mnt-by:         AFRINIC-HM-MNT mnt-lower:      CAFENET-NOC source:         AFRINIC # Filtered Note: the C&C domain is currently sinkholed by Kaspersky Lab
Turla-securelist.csv,80.248.65.0/24,have,NET,ip_addr/ip_addr:port/port,0,0,,]org The domain has the following pDNS IP: 80.248.65.183  80.248.65.183 aut-num:        AS30982 announcement:   80.248.65.0/24 as-name:        CAFENET descr:          CAFE Informatique et telecommunications admin-c:        YN2-AFRINIC tech-c:         AN39-AFRINIC org:            ORG-CIet1-AFRINIC mnt-by:         AFRINIC-HM-MNT mnt-lower:      CAFENET-NOC source:         AFRINIC # Filtered 1 2 3 4 5 6 7 8 9 10 11 80.248.65.183 aut-num:        AS30982 announcement:   80.248.65.0/24 as-name:        CAFENET descr:          CAFE Informatique et telecommunications admin-c:        YN2-AFRINIC tech-c:         AN39-AFRINIC org:            ORG-CIet1-AFRINIC mnt-by:         AFRINIC-HM-MNT mnt-lower:      CAFENET-NOC source:         AFRINIC # Filtered Note: the C&C domain is currently sinkholed by Kaspersky Lab
Turla-trellix.csv,0x457f,fullword,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,ascii fullword $s5 = /tmp/.sync.pid ascii fullword $s6 = rem_fd: ssl  ascii fullword $s7 = TREX_PID=%u ascii fullword $s8 = /tmp/.xdfg ascii fullword $s9 = __we_are_happy__ ascii fullword $s10 = /root/.sess ascii fullword $s11 = ZYSZLRTS^Z@@NM@@G_Y_FE ascii fullword condition: uint16(0) == 0x457f and filesize < 5000KB and 4 of them }
Turla-trellix.csv,0x457f,,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,, YARA	rule APT_MAL_LNX_Turla_Apr202004_1_opcode { meta: description = Detects Turla Linux malware x64 x32 date = 2020-04-24 hash1 = 67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502 hash2 = 8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc hash3 = 8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667 hash4 = 1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905 hash5 = 2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08 hash6 = 3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4 hash7 = 5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8 hash8 = 8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667 hash9 = d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0  strings: $op0 = { 8D 41 05 32 06 48 FF C6 88 81 E0 80 69 00 } /* Xor string loop_p1 x32*/ $op1 = { 48 FF C1 48 83 F9 49 75 E9 } /* Xor string loop_p2 x32*/ $op2 = { C7 05 9B 7D 29 00 1D 00 00 00 C7 05 2D 7B 29 00 65 74 68 30 C6 05 2A 7B 29 00 00 E8 } /* Load eth0 interface*/ $op3 = { BF FF FF FF FF E8 96 9D 0A 00 90 90 90 90 90 90 90 90 90 90 89 F0} /* Opcode exceptions*/ $op4 = { 88 D3 80 C3 05 32 9A C1 D6 0C 08 88 9A 60 A1 0F 08 42 83 FA 08 76 E9 } /* Xor string loop x64*/ $op5 = { 8B 8D 50 DF FF FF B8 09 00 00 00 89 44 24 04 89 0C 24 E8 DD E5 02 00 } /* Kill call x32 */ $op6 = { 8D 5A 05 32 9A 60 26 0C 08 88 9A 20 F4 0E 08 42 83 FA 48 76 EB } /* Decrypt init str */ $op7 = { 8D 4A 05 32 8A 25 26 0C 08 88 8A 20 F4 0E 08 42 83 FA 08 76 EB} /* Decrypt init str */ condition: uint16(0) == 0x457f and filesize < 5000KB and 2 of them }
