report,word,verb,objectType,prettyReg,match,label,asgSyscall,sentence
EvilGnome-intezer.csv,~/.cache/gnome-software/gnome-shell-extensions/tmp/:,store/set,FILE,/tmp.*,1,1,write(),"The modules encrypt their output and decrypt data from the C2 with RC5 with the key “sdg62_AS.sa$die3”, using a modified version of a Russian open source library https://webhamster.ru/site/page/index/articles/projectcode/157: pasted image 0 19 Figure 12: RC5 library On connection failure, or if instructed by the C2, these modules store their output at ~/.cache/gnome-software/gnome-shell-extensions/tmp/: pasted image 0 23 Figure 13: Stored files We will now dive into each of the five modules and their options: ShooterPing The ShooterPing module processes commands received from the C2: pasted image 0 29 Figure 14: C2 commands These include: Download & execute new files Set new filters for file scanning Download & set new runtime configuration Exfiltrate stored output to C2 Stop the shooter modules from running The other modules run at a constant interval between each run, as defined by one of the configuration parameters"
EvilGnome-intezer.csv,rtp.dat,be/create,FILE,rtp.dat,1,1,open(),"The agent then reads the rtp.dat configuration file and loads it directly into memory: pasted image 0 32 Figure 9: Loading configuration from rtp.dat We marked interesting fields within the configuration file: rtpdat2 Figure 10: Configuration dissection The first four bytes are a hexadecimal representation of the C2’s IP address: 0x65343ec3 ->  0xc3.0x3e.0x34.0x65 -> 195.62.52.101 Modules The spy agent contains five modules called “Shooters”: pasted image 0 35 Figure 11: “Shooter” modules ShooterSound – captures audio from the user’s microphone and uploads to C2 ShooterImage – captures screenshots and uploads to C2 ShooterFile – scans the file system for newly created files and uploads them to C2 ShooterPing – receives new commands from C2 ShooterKey – unimplemented and unused, most likely an unfinished keylogging module Each module is run in a separate thread, and access to shared resources (such as the configuration) is safeguarded by mutexes"
EvilGnome-intezer.csv,"rtp.dat,",,FILE,rtp.dat,0,0,,"Using default configuration from rtp.dat, the module records only a size of 80,000 bytes of audio per iteration"
EvilGnome-intezer.csv,rtp.dat,execute,FILE,rtp.dat,0,0,,"Using makeself’s options, we are able to instruct the script to unpack itself without executing: pasted image 0 28 Figure 6: Unpacking Makeself The archive contains four files: gnome-shell-ext – the spy agent executable gnome-shell-ext.sh – checks if gnome-shell-ext is already running and if not, executes it rtp.dat – configuration file for gnome-shell-ext setup.sh – the setup script that is run by makeself after unpacking The setup script installs the agent to ~/.cache/gnome-software/gnome-shell-extensions/, in an attempt to masquerade itself as a Gnome shell extension"
EvilGnome-intezer.csv,0x65343ec3,be,MEM,"0x[0-9a-zA-Z]{1,16} (mem)",0,0,,"The agent then reads the rtp.dat configuration file and loads it directly into memory: pasted image 0 32 Figure 9: Loading configuration from rtp.dat We marked interesting fields within the configuration file: rtpdat2 Figure 10: Configuration dissection The first four bytes are a hexadecimal representation of the C2’s IP address: 0x65343ec3 ->  0xc3.0x3e.0x34.0x65 -> 195.62.52.101 Modules The spy agent contains five modules called “Shooters”: pasted image 0 35 Figure 11: “Shooter” modules ShooterSound – captures audio from the user’s microphone and uploads to C2 ShooterImage – captures screenshots and uploads to C2 ShooterFile – scans the file system for newly created files and uploads them to C2 ShooterPing – receives new commands from C2 ShooterKey – unimplemented and unused, most likely an unfinished keylogging module Each module is run in a separate thread, and access to shared resources (such as the configuration) is safeguarded by mutexes"
EvilGnome-intezer.csv,195.62.52.101,be,NET,ip_addr/ip_addr:port/port,0,0,,"The agent then reads the rtp.dat configuration file and loads it directly into memory: pasted image 0 32 Figure 9: Loading configuration from rtp.dat We marked interesting fields within the configuration file: rtpdat2 Figure 10: Configuration dissection The first four bytes are a hexadecimal representation of the C2’s IP address: 0x65343ec3 ->  0xc3.0x3e.0x34.0x65 -> 195.62.52.101 Modules The spy agent contains five modules called “Shooters”: pasted image 0 35 Figure 11: “Shooter” modules ShooterSound – captures audio from the user’s microphone and uploads to C2 ShooterImage – captures screenshots and uploads to C2 ShooterFile – scans the file system for newly created files and uploads them to C2 ShooterPing – receives new commands from C2 ShooterKey – unimplemented and unused, most likely an unfinished keylogging module Each module is run in a separate thread, and access to shared resources (such as the configuration) is safeguarded by mutexes"
EvilGnome-intezer.csv,185.158.115.44,use/download,NET,ip_addr/ip_addr:port/port,1,1,send(),"We then checked for the 3436 port over three currently operating Gamaredon Group C2 servers, and found one server with this port open, serving SSH: pasted image 0 33 Figure 4: SSH served on port 3436 both on EvilGnome C2 and Gamaredon’s rnbo-ua.ddns.net We proceeded to scan for this network fingerprint under EvilGnome’s host provider and we identified two additional servers with domain names similar to the naming pattern of Gamaredon domains (the use of the .space TTLD and ddns): 185.158.115.44 -> kotl.space 185.158.115.154 -> clsass.ddns.net Tool Similarities Gamaredon Group does not use any known Linux implants"
EvilGnome-intezer.csv,(195.62.52.101),,NET,ip_addr/ip_addr:port/port,0,0,,"More specifically, EvilGnome’s C2 IP address (195.62.52.101) was resolved two months ago by the domains gamework.ddns.net and workan.ddns.net, associated with the Gamaredon Group: Figure 2: RiskIQ EvilGnome C2 IP query We used RiskIQ to map the history of the gamework.ddns.net domain: pasted image 0 24 Figure 3: gamework.ddns.net DNS timeline The finding shows that EvilGnome operates on an IP address that was controlled by the Gamaredon group two months ago"
