report,word,verb,objectType,prettyReg,match,label,asgSyscall,sentence
Dofloo-MalwareMustDie.csv,0x0002f120,"r1,r2,r10,r11,lr",MEM,0x[0-9a-zA-Z]{8} (mem),0,0,,"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ;-- entry0: 0x0002f118  adr     r12, off_2f104 0x0002f11c  ldmia   r12, {r1,r2,r10,r11,lr} 0x0002f120  add     r10, r10, r12 0x0002f124  add     r11, r11, r12 0x0002f128  mov     r0, r2 0x0002f12c  sub     r9, r12, r1 0x0002f130  add     r1, r1, #0x1000 0x0002f134  mov     r3, #0 0x0002f138  stmfd   sp!, {r0-r3,lr} 0x0002f13c  mov     r2, #7 0x0002f140  ldr     r3, [r12,#0x10] 0x0002f144  mov     r5, #0 0x0002f148  mov     r4, 0xffffffff 0x0002f14c  orr     r3, r3, #0x10 0x0002f150  mov     r7, #0xc0 0x0002f154  svc     0 0x0002f158  cmn     r0, #0x1000 0x0002f15c  bcs     loc_0x02fbd0   [...]  ..following the registers value and in r1 we will find the value that can tell what is happening:  1 2 3 4 5 0x0002fbd0  mov  r2, #0x1e 0x0002fbd4  adr  r1, aprot_execprot_ ; PROT_EXEC|PROT_WRITE failed.\n 0x0002fbd8  mov  r0, #2 0x0002fbdc  mov  r7, #4 0x0002fbe0  svc  0 This value may ring your bells too :)."
Dofloo-MalwareMustDie.csv,0x0002FBF0,look/change,MEM,0x[0-9a-zA-Z]{8} (mem),1,1,brk(),"I look from its DCB data from where it was called and clarifying the answer:  1 2 3 4 5 6 7 8 9 10 11 0x0002FBF0 aProt_execProt_ DCB PROT_EXEC|PROT_WRITE failed.,0xA,0 0x0002FC0E                 DCB 0xA,0 0x0002FC10 aInfoThisFileIs DCB 0x24,Info: This file is packed with the UPX executable packer http:/ 0x0002FC10                 DCB /upx.sf.net ,0x24,0xA,0 0x0002FC5F aIdUpx3_91Copyr DCB 0x24,Id: UPX 3.91 Copyright (C) 1996-2013 the UPX Team."
Dofloo-MalwareMustDie.csv,0x0002FC5F,eserve,MEM,0x[0-9a-zA-Z]{8} (mem),0,0,,All Rights R 0x0002FC5F                 DCB eserved.
Dofloo-MalwareMustDie.csv,0x0002fbd0,find/set,MEM,0x[0-9a-zA-Z]{8} (mem),1,1,set_robust_list() set_thread_area() mprotect() arch_prctl() set_tid_address(),"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ;-- entry0: 0x0002f118  adr     r12, off_2f104 0x0002f11c  ldmia   r12, {r1,r2,r10,r11,lr} 0x0002f120  add     r10, r10, r12 0x0002f124  add     r11, r11, r12 0x0002f128  mov     r0, r2 0x0002f12c  sub     r9, r12, r1 0x0002f130  add     r1, r1, #0x1000 0x0002f134  mov     r3, #0 0x0002f138  stmfd   sp!, {r0-r3,lr} 0x0002f13c  mov     r2, #7 0x0002f140  ldr     r3, [r12,#0x10] 0x0002f144  mov     r5, #0 0x0002f148  mov     r4, 0xffffffff 0x0002f14c  orr     r3, r3, #0x10 0x0002f150  mov     r7, #0xc0 0x0002f154  svc     0 0x0002f158  cmn     r0, #0x1000 0x0002f15c  bcs     loc_0x02fbd0   [...]  ..following the registers value and in r1 we will find the value that can tell what is happening:  1 2 3 4 5 0x0002fbd0  mov  r2, #0x1e 0x0002fbd4  adr  r1, aprot_execprot_ ; PROT_EXEC|PROT_WRITE failed.\n 0x0002fbd8  mov  r0, #2 0x0002fbdc  mov  r7, #4 0x0002fbe0  svc  0 This value may ring your bells too :)."
Dofloo-MalwareMustDie.csv,0x00008000,LOAD,MEM,0x[0-9a-zA-Z]{8} (mem),0,0,,"So as you can see it was served from Sept 10th and is having 4 downloads (including me, one time)  The file looks like this:  1 2 3 4 5 6 $ ls -alF 1 -rwxr--r--  1 mmd  mmd  165,176 Sep 10 10:21 1 $ md5 1 MD5 (1) = 0bb68bd65d94f61b7b20117b99d8526c $ file 1 1: ELF 32-bit LSB executable, ARM, version 1 (GNU/Linux), statically linked, stripped  Well, we know is an ARM binary, but I need more information, so I check the ELF composition:  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15   Entry point address:  0x2f118   Start of program headers: 52 (bytes into file)   Start of section headers: 0 (bytes into file)   Flags: 0x4000002, has entry point, Version4 EABI   Size of this header: 52 (bytes)   Size of program headers: 32 (bytes)   Number of program headers: 2   Size of section headers: 40 (bytes)   Number of section headers: 0   Section header string table index: 0   Program Headers:   Type     Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align   LOAD     0x000000 0x00008000 0x00008000 0x282b1 0x282b1 R E 0x8000   LOAD     0x000c24 0x000d0c24 0x000d0c24 0x00000 0x00000 RW  0x8000 Now it's time for calculating the data, we know the size and we see the each LOAD headers size which is just unfit, further, I don't see any section (either dynamic or static) nor relocation data that I can expect from an ARM ELF (they should have more symbols), which is strange."
Dofloo-MalwareMustDie.csv,0x0002FC0E,,MEM,0x[0-9a-zA-Z]{8} (mem),0,0,,"I look from its DCB data from where it was called and clarifying the answer:  1 2 3 4 5 6 7 8 9 10 11 0x0002FBF0 aProt_execProt_ DCB PROT_EXEC|PROT_WRITE failed.,0xA,0 0x0002FC0E                 DCB 0xA,0 0x0002FC10 aInfoThisFileIs DCB 0x24,Info: This file is packed with the UPX executable packer http:/ 0x0002FC10                 DCB /upx.sf.net ,0x24,0xA,0 0x0002FC5F aIdUpx3_91Copyr DCB 0x24,Id: UPX 3.91 Copyright (C) 1996-2013 the UPX Team."
Dofloo-MalwareMustDie.csv,0x0002FC10,pack,MEM,0x[0-9a-zA-Z]{8} (mem),0,0,,"I look from its DCB data from where it was called and clarifying the answer:  1 2 3 4 5 6 7 8 9 10 11 0x0002FBF0 aProt_execProt_ DCB PROT_EXEC|PROT_WRITE failed.,0xA,0 0x0002FC0E                 DCB 0xA,0 0x0002FC10 aInfoThisFileIs DCB 0x24,Info: This file is packed with the UPX executable packer http:/ 0x0002FC10                 DCB /upx.sf.net ,0x24,0xA,0 0x0002FC5F aIdUpx3_91Copyr DCB 0x24,Id: UPX 3.91 Copyright (C) 1996-2013 the UPX Team."
Dofloo-MalwareMustDie.csv,0x0002FCAB,go,MEM,0x[0-9a-zA-Z]{8} (mem),0,0,,",0x24,0xA,0 0x0002FCAB                 DCB 0x0 ;; here goes the table.. 0x0002FCAC                 DCD 0x9A8, 0x5F9, 0x500E, 0x6C00031A, 0x942C5302, 0x18D063CB 0x0002FCAC                 DCD 0x49382EE, 0xD185E779, 0x57399E2E, 0xD24C892F, 0x1003EA02 0x0002FCAC                 DCD 0x6A5A70C9, 0x2F701D6A, 0x6D0D9A7, 0xD2EC6754, 0x95ECE49 [...]                      [...]  Oh, silly me.. it is a UPX, but, is it common and not modded one?"
Dofloo-MalwareMustDie.csv,0x0002f118,add,MEM,0x[0-9a-zA-Z]{8} (mem),0,0,,"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ;-- entry0: 0x0002f118  adr     r12, off_2f104 0x0002f11c  ldmia   r12, {r1,r2,r10,r11,lr} 0x0002f120  add     r10, r10, r12 0x0002f124  add     r11, r11, r12 0x0002f128  mov     r0, r2 0x0002f12c  sub     r9, r12, r1 0x0002f130  add     r1, r1, #0x1000 0x0002f134  mov     r3, #0 0x0002f138  stmfd   sp!, {r0-r3,lr} 0x0002f13c  mov     r2, #7 0x0002f140  ldr     r3, [r12,#0x10] 0x0002f144  mov     r5, #0 0x0002f148  mov     r4, 0xffffffff 0x0002f14c  orr     r3, r3, #0x10 0x0002f150  mov     r7, #0xc0 0x0002f154  svc     0 0x0002f158  cmn     r0, #0x1000 0x0002f15c  bcs     loc_0x02fbd0   [...]  ..following the registers value and in r1 we will find the value that can tell what is happening:  1 2 3 4 5 0x0002fbd0  mov  r2, #0x1e 0x0002fbd4  adr  r1, aprot_execprot_ ; PROT_EXEC|PROT_WRITE failed.\n 0x0002fbd8  mov  r0, #2 0x0002fbdc  mov  r7, #4 0x0002fbe0  svc  0 This value may ring your bells too :)."
Dofloo-MalwareMustDie.csv,0x0002f144,svc,MEM,0x[0-9a-zA-Z]{8} (mem),0,0,,"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ;-- entry0: 0x0002f118  adr     r12, off_2f104 0x0002f11c  ldmia   r12, {r1,r2,r10,r11,lr} 0x0002f120  add     r10, r10, r12 0x0002f124  add     r11, r11, r12 0x0002f128  mov     r0, r2 0x0002f12c  sub     r9, r12, r1 0x0002f130  add     r1, r1, #0x1000 0x0002f134  mov     r3, #0 0x0002f138  stmfd   sp!, {r0-r3,lr} 0x0002f13c  mov     r2, #7 0x0002f140  ldr     r3, [r12,#0x10] 0x0002f144  mov     r5, #0 0x0002f148  mov     r4, 0xffffffff 0x0002f14c  orr     r3, r3, #0x10 0x0002f150  mov     r7, #0xc0 0x0002f154  svc     0 0x0002f158  cmn     r0, #0x1000 0x0002f15c  bcs     loc_0x02fbd0   [...]  ..following the registers value and in r1 we will find the value that can tell what is happening:  1 2 3 4 5 0x0002fbd0  mov  r2, #0x1e 0x0002fbd4  adr  r1, aprot_execprot_ ; PROT_EXEC|PROT_WRITE failed.\n 0x0002fbd8  mov  r0, #2 0x0002fbdc  mov  r7, #4 0x0002fbe0  svc  0 This value may ring your bells too :)."
Dofloo-MalwareMustDie.csv,ethernet,grab,NET,^eth.*,0,0,,"how it grabs the ethernet data, or how this malware use socket to connect an IP, for example, since the code is too long."
Dofloo-MalwareMustDie.csv,182.254.180.241,be,NET,ip_addr/ip_addr:port/port,0,0,,"1 2 .text:0x09E68 LDR  R0, =unk_0x08C5C4  <-- address to get the CNC IP Address .text:0x09E68 <-- go down to hard-copied data:0x08C5C8 it's the IP 182.254.180.241  Now we know the CNC is in 182.254.180.241 which is in: ?"
Dofloo-MalwareMustDie.csv,182.254.180.0/23,,NET,ip_addr/ip_addr:port/port,0,0,,"1 2 3 4 ASN: 45090 / CNNIC-TENCENT-NET PREFIX: 182.254.180.0/23 ISP: COMSENZ TECHNOLOGY LTD COUNTRY: CHINA ..well, I am not surprised."
Dofloo-MalwareMustDie.csv,sed,,PROC,^sed$,0,0,,"1 2 3 4 5 6 7 8 9 10 11 .text:0x0A760  STMFD   SP!, {R4-R8,LR} .text:0x0A764  SUB  SP, SP, #0x208 .text:0x0A768  ADD  R7, SP, #0x108 .text:0x0A76C  MOV  R4, R0 .text:0x0A770  MOV  R8, R1 .text:0x0A774  MOV  R0, R7 .text:0x0A778  MOV  R1, #0x100 .text:0x0A77C  BL   sub_0x026FB0 .text:0x0A780  LDR  R0,  <-- chattr -i /etc/crontab .text:0x0A784  BL   sub_0x0E3E0 .text:0x0A788  LDR  R0, <-- chmod +w /etc/crontab  Adding the autostart entry in it:  1 2 3 4 5 6 7 8 9 10 .text:0x0A7DC ; xref: sub_0x0A760 .text:0x0A7DC  LDR  R1, <-- sed -i '/%s/d' /etc/crontab .text:0x0A7E0  MOV  R2, R5 .text:0x0A7E4  MOV  R0, R6    : .text:0x0A800  LDR  R1, <-- echo '*/1 * * * * root %s/%s %s' >> /etc/crontab .text:0x0A804  STR  R8, [SP,#0x108+var_108] .text:0x0A808  BL   sub_0x0182DC .text:0x0A80C  MOV  R0, R6 .text:0x0A810  BL   sub_0x0E3E0  Create the file: /etc/.mysys, which later on found as the self copy attempt."
Dofloo-Securityaffairs.csv,"/etc/rc.d/rc.local,",,FILE,/etc/rc.*\.d/.*,0,0,,"Trend Micro researchers also discovered that the latest variant of the AESDDoS bot can modify files i.e., /etc/rc.local and /etc/rc.d/rc.local, as an autostart technique by appending the {malware path}/{malware file name} reboot command."
Dofloo-Securityaffairs.csv,/etc/rc.local,modify,FILE,/etc/rc\.local,1,1,rename(),"Trend Micro researchers also discovered that the latest variant of the AESDDoS bot can modify files i.e., /etc/rc.local and /etc/rc.d/rc.local, as an autostart technique by appending the {malware path}/{malware file name} reboot command."
Dofloo-Securityaffairs.csv,23.224.59.34:48080,connect,NET,ip_addr/ip_addr:port/port,1,1,connect(),The malware also connects to 23.224.59.34:48080 to send and receive remote shell commands from the attacker.
Dofloo-Securityaffairs.csv,23.224.59.34:48080,connect,NET,ip_addr/ip_addr:port/port,1,1,connect(),The malware also connects to 23.224.59.34:48080 to send and receive remote shell commands from the attacker.
Dofloo-SyscallParty.csv,/etc/init.d/boot.local,add,FILE,/etc/init\.d/.*,1,1,open(),Persistence Persistence is achieved by the malware by adding to /etc/rc.local and the /etc/init.d/boot.local files (in the auto_boot function); however before it overwrites this file it first checks to see if it has already done so.
Dofloo-SyscallParty.csv,/etc/rc.local,execute,FILE,/etc/rc\.local,0,0,,The /etc/rc.local will execute certain commands after all of the systems' services have started.
Dofloo-SyscallParty.csv,/etc/rc.local,format,FILE,/etc/rc\.local,1,1,rename(),"A string is formatted and the sed program is called which writes to the file in question (there are several string operations, such as sed -i -e '2 i%s/%s' /etc/rc.local is formatted for example)."
Dofloo-SyscallParty.csv,/etc/rc.local,add,FILE,/etc/rc\.local,1,1,open(),Persistence Persistence is achieved by the malware by adding to /etc/rc.local and the /etc/init.d/boot.local files (in the auto_boot function); however before it overwrites this file it first checks to see if it has already done so.
Dofloo-SyscallParty.csv,/proc/net/dev,read,FILE,/proc/net/dev,1,1,read(),The way the malware gets information regarding the network adapter is reading the /proc/net/dev file.
Dofloo-SyscallParty.csv,/proc/self/exe,,FILE,/proc/self,0,0,,The main method then branches to function named get_executable_name which reads the symlink /proc/self/exe via readlink(..).
Dofloo-SyscallParty.csv,vaddr=0x00013dec,give,MEM,0x[0-9a-zA-Z]{8} (mem),0,0,,Which gives us the following output:  vaddr=0x00013dec paddr=0x0000bdec ord=5366 fwd=NONE sz=688 bind=GLOBAL type=FUNC name=main Nice!
Dofloo-SyscallParty.csv,61.147.91.53.,,NET,ip_addr/ip_addr:port/port,0,0,,We pass in the first parameter in the register ‘r0’ from the location 0xC1FC8 which has the value of 61.147.91.53.
Dofloo-SyscallParty.csv,sed,format,PROC,^sed$,0,0,,"A string is formatted and the sed program is called which writes to the file in question (there are several string operations, such as sed -i -e '2 i%s/%s' /etc/rc.local is formatted for example)."
Dofloo-Trendmicro.csv,/etc/init.d/boot.local,,FILE,/etc/init\.d/.*,0,0,, Installation  This Backdoor adds the following processes:  sed -i -e '/exit/d' /etc/rc.local sed -i -e '/^\r\n|\r|\n$/d' /etc/rc.local sed -i -e '/%s/d' /etc/rc.local sed -i -e '2 i%s/%s' /etc/rc.local sed -i -e '2 i%s/%s start' /etc/rc.d/rc.local sed -i -e '2 i%s/%s start' /etc/init.d/boot.local Backdoor Routine 
Dofloo-Trendmicro.csv,/etc/rc.d/rc.local,,FILE,/etc/rc.*\.d/.*,0,0,, Installation  This Backdoor adds the following processes:  sed -i -e '/exit/d' /etc/rc.local sed -i -e '/^\r\n|\r|\n$/d' /etc/rc.local sed -i -e '/%s/d' /etc/rc.local sed -i -e '2 i%s/%s' /etc/rc.local sed -i -e '2 i%s/%s start' /etc/rc.d/rc.local sed -i -e '2 i%s/%s start' /etc/init.d/boot.local Backdoor Routine 
Dofloo-Trendmicro.csv,/etc/rc.local,,FILE,/etc/rc\.local,0,0,, Installation  This Backdoor adds the following processes:  sed -i -e '/exit/d' /etc/rc.local sed -i -e '/^\r\n|\r|\n$/d' /etc/rc.local sed -i -e '/%s/d' /etc/rc.local sed -i -e '2 i%s/%s' /etc/rc.local sed -i -e '2 i%s/%s start' /etc/rc.d/rc.local sed -i -e '2 i%s/%s start' /etc/init.d/boot.local Backdoor Routine 
Dofloo-Trendmicro.csv,/proc/net/dev,,FILE,/proc/net/dev,0,0,, This Backdoor gathers the following data:  CPU information Memory statistics IP address of infected machine Reads the following information from /proc: /proc/stat /proc/meminfo /proc/cpuinfo /proc/net/dev /proc/self/exe /proc/self/maps /proc/sys/vm/overcommit_memory /proc/sys/kernel/rtsig-max /proc/sys/kernel/ngroups_max /proc/sys/kernel/osrelease /proc/self/fd/%d/%s /proc/self/fd /proc/net Other Details 
Dofloo-Trendmicro.csv,/proc/self/exe,,FILE,/proc/self,0,0,, This Backdoor gathers the following data:  CPU information Memory statistics IP address of infected machine Reads the following information from /proc: /proc/stat /proc/meminfo /proc/cpuinfo /proc/net/dev /proc/self/exe /proc/self/maps /proc/sys/vm/overcommit_memory /proc/sys/kernel/rtsig-max /proc/sys/kernel/ngroups_max /proc/sys/kernel/osrelease /proc/self/fd/%d/%s /proc/self/fd /proc/net Other Details 
Dofloo-Trendmicro.csv,/proc/stat,gather,FILE,/proc/stat,1,1,read(), This Backdoor gathers the following data:  CPU information Memory statistics IP address of infected machine Reads the following information from /proc: /proc/stat /proc/meminfo /proc/cpuinfo /proc/net/dev /proc/self/exe /proc/self/maps /proc/sys/vm/overcommit_memory /proc/sys/kernel/rtsig-max /proc/sys/kernel/ngroups_max /proc/sys/kernel/osrelease /proc/self/fd/%d/%s /proc/self/fd /proc/net Other Details 
Dofloo-Trendmicro.csv,sed,,PROC,^sed$,0,0,, Installation  This Backdoor adds the following processes:  sed -i -e '/exit/d' /etc/rc.local sed -i -e '/^\r\n|\r|\n$/d' /etc/rc.local sed -i -e '/%s/d' /etc/rc.local sed -i -e '2 i%s/%s' /etc/rc.local sed -i -e '2 i%s/%s start' /etc/rc.d/rc.local sed -i -e '2 i%s/%s start' /etc/init.d/boot.local Backdoor Routine 
